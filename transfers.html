<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Transfers — Football News Official</title>
  <meta name="description" content="Latest football transfers, deals, and rumors." />
  <style>
  
    :root{--accent:#ff0000;--card:#141414;--bg:#000;--text:#f5f5f5}
    *{box-sizing:border-box}
    body{margin:0;font-family:ui-sans-serif,system-ui,Arial,Roboto;background:linear-gradient(180deg,var(--bg),#120000);color:var(--text)}
    header{background:linear-gradient(90deg,#000,#4a0000);padding:.8rem 1rem;position:sticky;top:0;z-index:20}
    .nav{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
    .brand{font-weight:900;color:var(--text);text-decoration:none}
    main{max-width:1200px;margin:1.5rem auto;padding:0 1rem}
    .toolbar{display:flex;gap:.6rem;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-bottom:.8rem}
    .toolbar .left{display:flex;gap:.5rem;flex-wrap:wrap}
    input,select,button{padding:.5rem .7rem;border-radius:8px;border:1px solid #333;background:#0f0f0f;color:var(--text)}
    .btn{background:var(--accent);border:none;color:white;font-weight:800;border-radius:8px}
    .tablewrap{overflow:auto;border-radius:10px;border:1px solid #222}
    table{width:100%;border-collapse:collapse;min-width:1100px}
    th,td{padding:.6rem;border-bottom:1px solid #222;text-align:left;white-space:nowrap}
    th{position:sticky;top:0;background:#101010;color:#ff6666}
    tr:hover td{background:rgba(255,255,255,.02)}
    .fav{cursor:pointer}
    #backToTop{position:fixed;right:20px;bottom:20px;width:44px;height:44px;border-radius:50%;border:none;background:var(--accent);display:none;color:#fff}
    .muted{color:#aaa;font-size:.95rem}
  </style>
</head>
<body>
  <header>
    <div class="nav">
      <a class="brand" href="index.html">Football News</a>
      <div>
        <a href="index.html" style="color:#ddd;text-decoration:none;margin-right:1rem">Home</a>
        <a href="analysis.html" style="color:#ddd;text-decoration:none;margin-right:1rem">Analysis</a>
        <a href="contact.html" style="color:#eb0e0e;text-decoration:none;margin-right:1rem">Contact</a>
        <a href="news.html" style="color:#eb0e0e;text-decoration:none">news</a>
      </div>
    </div>
  </header>

  <main>
    <h1 style="text-align:center;color:#ff4444">Transfers</h1>

    <div class="toolbar" role="region">
      <div class="left">
        <input id="q" type="search" placeholder="Search player or club (/ to focus)" />
        <select id="pos"><option value="">All pos</option><option>GK</option><option>DF</option><option>MF</option><option>FW</option></select>
        <select id="status"><option value="">All status</option><option>Official</option><option>Here we go</option><option>Advanced</option><option>Rumour</option></select>
        <select id="sort"><option value="date_desc">Newest</option><option value="date_asc">Oldest</option><option value="fee_desc">Fee high→low</option><option value="fee_asc">Fee low→high</option></select>
        <button id="reset" class="btn">Reset</button>
      </div>
      <div class="right" style="display:flex;gap:.5rem">
        <button id="export" class="btn">Export CSV</button>
        <button id="showFavs" class="btn">Favorites</button>
      </div>
    </div>

    <div class="tablewrap" role="region" aria-label="Transfers table">
      <table id="tbl">
        <thead>
          <tr><th>★</th><th>Player</th><th>From</th><th>To</th><th>Fee (€)</th><th>Contract</th><th>Pos</th><th>Status</th><th>Date</th><th>Notes</th></tr>
        </thead>
        <tbody id="tbody"><tr><td colspan="10" class="muted">Loading…</td></tr></tbody>
      </table>
    </div>

    <div style="display:flex;justify-content:center;gap:.75rem;margin-top:.8rem">
      <button id="prev" class="btn">Prev</button>
      <div id="pageInfo" class="muted" aria-live="polite"></div>
      <button id="next" class="btn">Next</button>
    </div>

    <p style="margin-top:1rem" class="muted">Tip: publish a Google Sheet and set the SHEET_ID below. Or edit the local seed JSON inside this file.</p>
  </main>

  <button id="backToTop" title="Back to top">↑</button>

  <script>
  /* ---------- CONFIG ----------
     Replace SHEET_ID with your Google Sheet ID. Sheet should be published or shared public.
     Example gviz url:
     https://docs.google.com/spreadsheets/d/SHEET_ID/gviz/tq?tqx=out:json&sheet=Sheet1
     --------------------------------*/
  const SHEET_ID = 'SHEET_ID'; // <-- replace
  const SHEET_NAME = 'Sheet1';  // name of worksheet tab

  // fallback seed
  let data = [
  {"player":"Florian Wirtz","from":"Bayer Leverkusen","to":"Liverpool","fee":"€100M (up to €116.5M)","pos":"AM","status":"Official","date":"2025-06-20"},
  {"player":"Jeremie Frimpong","from":"Bayer Leverkusen","to":"Liverpool","fee":"£29.5M","pos":"DF","status":"Official","date":"2025-06-01"},
  {"player":"Milos Kerkez","from":"Bournemouth","to":"Liverpool","fee":"£40M","pos":"DF","status":"Official","date":"2025-06-26"},
  {"player":"Hugo Ekitiké","from":"Eintracht Frankfurt","to":"Liverpool","fee":"£69M (up to £79M)","pos":"FW","status":"Official","date":"2025-07-23"},
  {"player":"Alexander Isak","from":"Newcastle","to":"Liverpool","fee":"£125M (up to £130M)","pos":"FW","status":"Official","date":"2025-09-01"},
  {"player":"Eberechi Eze","from":"Crystal Palace","to":"Arsenal","fee":"£67.5M","pos":"MF","status":"Official","date":"2025-08-15"},
  {"player":"Piero Hincapié","from":"Bayer Leverkusen","to":"Arsenal","fee":"Loan","pos":"DF","status":"Official","date":"2025-09-01"},
  {"player":"Anthony Elanga","from":"Nottingham Forest","to":"Newcastle","fee":"£55M","pos":"RW","status":"Official","date":"2025-07-11"},
  {"player":"Malick Thiaw","from":"Milan","to":"Newcastle","fee":"£34.3M","pos":"CB","status":"Official","date":"2025-08-12"},
  {"player":"Jacob Ramsey","from":"Aston Villa","to":"Newcastle","fee":"£43M","pos":"CM","status":"Official","date":"2025-08-17"},
  {"player":"Nick Woltemade","from":"VfB Stuttgart","to":"Newcastle","fee":"£69M","pos":"ST","status":"Official","date":"2025-08-30"},
  {"player":"Yoane Wissa","from":"Brentford","to":"Newcastle","fee":"£55M","pos":"ST","status":"Official","date":"2025-09-01"},
  {"player":"Fer López","from":"Celta Vigo","to":"Wolves","fee":"£19.6M","pos":"RW","status":"Official","date":"2025-06-20"},
  {"player":"Jørgen Strand Larsen","from":"Unknown","to":"Wolves","fee":"£23M","pos":"CF","status":"Official","date":"2025-07-01"},
  {"player":"Jhon Arias","from":"Fluminense","to":"Wolves","fee":"Undisclosed","pos":"RW","status":"Official","date":"2025-07-24"},
  {"player":"David Møller Wolfe","from":"AZ","to":"Wolves","fee":"£10M","pos":"LB","status":"Official","date":"2025-08-02"},
  {"player":"Jackson Tchatchoua","from":"Hellas Verona","to":"Wolves","fee":"£10.8M","pos":"RB","status":"Official","date":"2025-08-18"},
  {"player":"Tolu Arokodare","from":"Genk","to":"Wolves","fee":"£24M","pos":"ST","status":"Official","date":"2025-09-01"},
  {"player":"Dário Essugo","from":"Sporting CP","to":"Chelsea","fee":"£18M","pos":"DM","status":"Official","date":"2025-06-02"},
  {"player":"Liam Delap","from":"Ipswich Town","to":"Chelsea","fee":"£30M","pos":"ST","status":"Official","date":"2025-06-04"},
  {"player":"Mamadou Sarr","from":"Strasbourg","to":"Chelsea","fee":"£12M","pos":"DF","status":"Official","date":"2025-06-09"},
  {"player":"Kendry Páez","from":"Independiente del Valle","to":"Chelsea","fee":"£17.2M","pos":"AM","status":"Official","date":"2025-07-01"},
  {"player":"João Pedro","from":"Brighton","to":"Chelsea","fee":"£55M + add-ons","pos":"ST","status":"Official","date":"2025-07-02"},
  {"player":"Jamie Gittens","from":"Borussia Dortmund","to":"Chelsea","fee":"£48.5M + add-ons","pos":"LW","status":"Official","date":"2025-07-05"},
  {"player":"Jorrel Hato","from":"Ajax","to":"Chelsea","fee":"£35.5M + add-ons","pos":"LB","status":"Official","date":"2025-08-03"},
  {"player":"Estêvão","from":"Palmeiras","to":"Chelsea","fee":"£29M + add-ons","pos":"RW","status":"Official","date":"2025-08-05"},
  {"player":"Alejandro Garnacho","from":"Manchester United","to":"Chelsea","fee":"£40M","pos":"LW","status":"Official","date":"2025-08-30"}
];

// Render transfers in table
const tbody = document.querySelector("#transfersTable tbody");

transfers.forEach(t => {
  const row = document.createElement("tr");
  row.innerHTML = `
    <td>${t.player}</td>
    <td>${t.from}</td>
    <td>${t.to}</td>
    <td>${t.fee}</td>
    <td>${t.pos}</td>
    <td>${t.date}</td>
    <td>${t.status}</td>
  `;
  tbody.appendChild(row);
});

  ];

  // state
  const perPage = 12;
  let page = 1;
  let showFavs = false;
  const FKEY = 'fno_favs_v2';

  // elements
  const tbody = document.getElementById('tbody');
  const q = document.getElementById('q');
  const pos = document.getElementById('pos');
  const status = document.getElementById('status');
  const sort = document.getElementById('sort');
  const pageInfo = document.getElementById('pageInfo');

  // util
  const fmt = n => (n===0||n===null) ? 'Free' : new Intl.NumberFormat().format(n);
  const loadFavs = ()=> new Set(JSON.parse(localStorage.getItem(FKEY)||'[]'));
  const saveFavs = s=> localStorage.setItem(FKEY, JSON.stringify([...s]));

  function hashRow(r){ return `${r.player}|${r.from}|${r.to}|${r.date}`; }

  // fetch sheet if provided
  async function fetchSheet(){
    if(!SHEET_ID || SHEET_ID==='SHEET_ID') return false;
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(SHEET_NAME)}`;
    try{
      const res = await fetch(url);
      const txt = await res.text();
      // gviz returns )]}\'\n + json
      const json = JSON.parse(txt.replace(/^[^\{]+/,''));
      const rows = json.table.rows;
      const cols = json.table.cols.map(c => c.label || c.id || '');
      const out = rows.map(r => {
        const obj = {};
        r.c.forEach((cell,i)=>{
          const key = cols[i] ? cols[i].toString().trim().toLowerCase() : `col${i}`;
          obj[key] = cell && cell.v !== null ? cell.v : '';
        });
        // map expected keys to our normalized schema
        return {
          player: obj.player || obj.name || obj.col0 || '',
          from: obj.from || obj.clubfrom || obj.col1 || '',
          to: obj.to || obj.clubto || obj.col2 || '',
          fee: obj.fee || obj.price || obj.col3 || 0,
          contract: obj.contract || obj.col4 || '',
          pos: obj.pos || obj.position || obj.col5 || '',
          status: obj.status || obj.col6 || '',
          date: obj.date || obj.col7 || '',
          notes: obj.notes || obj.col8 || ''
        };
      });
      if(out.length) { data = out; return true; }
    }catch(err){
      console.warn('Sheet load failed', err);
    }
    return false;
  }

  // filtering / sorting
  function getFiltered(){
    const qv = (q.value||'').toLowerCase().trim();
    let arr = data.filter(r=>{
      if(qv){
        const blob = `${r.player} ${r.from} ${r.to} ${r.pos} ${r.status} ${r.notes}`.toLowerCase();
        if(!blob.includes(qv)) return false;
      }
      if(pos.value && r.pos !== pos.value) return false;
      if(status.value && r.status !== status.value) return false;
      return true;
    });

    // sort
    const st = sort.value;
    if(st==='date_desc') arr.sort((a,b)=> (b.date||'').localeCompare(a.date||''));
    else if(st==='date_asc') arr.sort((a,b)=> (a.date||'').localeCompare(b.date||''));
    else if(st==='fee_desc') arr.sort((a,b)=> (b.fee||0)-(a.fee||0));
    else if(st==='fee_asc') arr.sort((a,b)=> (a.fee||0)-(b.fee||0));
    return arr;
  }

  function render(){
    const filtered = getFiltered();
    if(showFavs){
      const favs = loadFavs();
      filtered = filtered.filter(r=> favs.has(hashRow(r)));
    }
    const total = filtered.length;
    const pages = Math.max(1, Math.ceil(total/perPage));
    if(page>pages) page = pages;
    const start = (page-1)*perPage; const slice = filtered.slice(start, start+perPage);

    tbody.innerHTML = slice.map(r=>{
      const favs = loadFavs();
      const star = favs.has(hashRow(r)) ? '⭐' : '☆';
      return `<tr>
        <td class="fav" data-key="${hashRow(r)}">${star}</td>
        <td>${r.player}</td>
        <td>${r.from}</td>
        <td>${r.to}</td>
        <td>${fmt(Number(r.fee))}</td>
        <td>${r.contract||''}</td>
        <td>${r.pos||''}</td>
        <td>${r.status||''}</td>
        <td>${r.date||''}</td>
        <td>${r.notes||''}</td>
      </tr>`;
    }).join('');
    if(slice.length===0) tbody.innerHTML = `<tr><td colspan="10" class="muted">No results</td></tr>`;
    pageInfo.textContent = `Page ${page} / ${pages} • ${total} result(s)`;
  }

  // events
  q.addEventListener('input', ()=>{ page=1; render(); });
  pos.addEventListener('change', ()=>{ page=1; render(); });
  status.addEventListener('change', ()=>{ page=1; render(); });
  sort.addEventListener('change', ()=>{ page=1; render(); });
  document.getElementById('reset').addEventListener('click', ()=>{ q.value=''; pos.value=''; status.value=''; sort.value='date_desc'; page=1; render(); });
  document.getElementById('prev').addEventListener('click', ()=>{ if(page>1){ page--; render(); }});
  document.getElementById('next').addEventListener('click', ()=>{ page++; render(); });

  // fav toggle
  document.getElementById('tbl').addEventListener('click', (e)=>{
    const td = e.target.closest('.fav'); if(!td) return;
    const key = td.dataset.key; const favs = loadFavs();
    if(favs.has(key)) favs.delete(key); else favs.add(key); saveFavs(favs); render();
  });

  // export CSV
  document.getElementById('export').addEventListener('click', ()=>{
    const arr = getFiltered();
    const head = ['player','from','to','fee','contract','pos','status','date','notes'];
    const rows = [head.join(',')].concat(arr.map(r=> head.map(k=> `"${String(r[k]||'').replace(/"/g,'""')}"`).join(',')));
    const b = new Blob([rows.join('\n')], {type:'text/csv'});
    const url = URL.createObjectURL(b); const a = document.createElement('a'); a.href=url; a.download='transfers.csv'; a.click(); URL.revokeObjectURL(url);
  });

  document.getElementById('showFavs').addEventListener('click', ()=>{
    showFavs = !showFavs; page = 1; render();
  });

  // keyboard shortcut "/" to focus search
  window.addEventListener('keydown', (e)=>{ if(e.key === '/'){ e.preventDefault(); q.focus(); }});

  // back to top
  const back = document.getElementById('backToTop');
  window.addEventListener('scroll', ()=> back.style.display = window.scrollY>300 ? 'block':'none');
  back.addEventListener('click', ()=> window.scrollTo({top:0,behavior:'smooth'}));

  // load flow: try sheet then fallback seed
  (async function init(){
    const ok = await fetchSheet();
    if(!ok) console.info('Sheet not loaded, using local seed');
    render();
  })();
  </script>
</body>
</html>



